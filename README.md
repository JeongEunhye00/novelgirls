# novelgirls
>  BERT와 LSTM 을 이용한 소설 속 인물 묘사 작문 (2021학년도 2학기 자연어처리 프로젝트) 

아래 사진 클릭 시 서비스 발표 영상으로 이동합니다👭

[![발표영상](https://img.youtube.com/vi/zum4tzQfw7Q/hqdefault.jpg)]( https://youtu.be/zum4tzQfw7Q)



------



## 훈련된 모델 다운

- eye color
  - ```BERT/trained_model/bert_eye_color```
  - https://drive.google.com/file/d/1Uvi63NsQV4j-LpZYMmpIjHi6JZkxzcD3/view?usp=sharing

- hair color
  - ```BERT/trained_model/bert_hair_color```
  - https://drive.google.com/file/d/1tJfdvmknNMfpj14VCB6GDV8_4R-PCCV5/view?usp=sharing




------



## 개발 필요성

소설을 읽을 때, 인물의 묘사만으로 독자의 몰입도가 떨어지거나 오를 수 있다. 예를 들어 콩쥐 팥쥐를 생각해보자. 심술이 가득한 얼굴로 집안일을 모두 하는 콩쥐, 선한 얼굴로 집안일을 모두 시키는 팥쥐라고 하면 뭔가 몰입이 깨질 것 같지 않을까? 

소설 작가는 인물의 성격을 설정하는 것과 더불어 인물의 외양 묘사에도 신경을 써야 독자들에게 자신이 상상한 그대로를 잘 전달할 수 있다. 그런데 많은 작가들이 인물 묘사에 어려움을 겪는지, 인물 묘사만을 설명한 책이 따로 출간되어 있다. 그 책에는 ‘외양 묘사’ 만을 설명하는 목차가 따로 있었는데, 이를 통해 작가들이 캐릭터 외양 묘사 글을 작성하는 데에 얼마나 고뇌하는지 알 수 있다. 

그래서 캐릭터의 특징을 입력하면, 캐릭터 소설 묘사 글을 생성해줌으로써, 소설을 쓰며 등장인물의 외형 묘사 글을 작성하고 싶을 때, 본 프로그램에 캐릭터의 외형적 특징만을 입력해주고, 생성된 묘사 글을 통해 캐릭터 묘사 글을 손쉽게 작성할 수 있도록 프로그램을 개발하였다.



______



## 개발 목표

얼굴 사진, 외형 정보 등을 가지고 소설 생성 글을 작성하는 서비스를 제공한다.

![image](https://user-images.githubusercontent.com/60170358/143964074-dde451bf-86ad-4c05-ad1e-03c92d6128df.png)

------



## 구현 기술

전체적인 다이어그램은 아래와 같다. 우리는 BERT와 LSTM 모델을 직접 학습시켜 기술을 구현하였다.

<img src="https://user-images.githubusercontent.com/60170358/143964267-f2c6d689-a105-414b-b647-ca0ad835157f.png" width="300" height="200"/>



### 1) BERT (Bidirectional Encoder Representations from Transformers)

2018년 구글이 공개한 사전 훈련된 언어모델으로, 자연어 처리와 관련된 여러 개의 task를 수행한다. 

- **문장 한 개 분류(Single Sentence Classification)**

- 문장 두 개의 관계 분류(Sentence Pair Classification)

- 문장 내 단어 라벨링(Single Sentence Tagging Task)

- 묻고 답하기(Quesiton & Answering) 등



우리는 이 중 문장 한 개 분류하는 작업을 사용할 것이고, BERT 모델의 학습은 아래의 사진과 같다.

얼굴 묘사 글을 보고 눈의 색과 머리의 색이 무엇인지 분류하는 작업을 수행한다. 얼굴 묘사 글은 이미지를 보고 직접 작성 하였다.

![image](https://user-images.githubusercontent.com/60170358/143965571-82662e06-4a94-4307-acb3-b796d5518941.png)



### 2) LSTM

RNN의 장기 의존성 문제(the problem of Long-Term Dependencies) 해결을 위해 나온 모델로, cell state라는 값을 추가하여, RNN과 비교하여 긴 시퀀스의 입력 처리가 가능한 모델이다. 

*장기 의존성 문제: 입 ∙ 출력을 sequence 단위로 처리하여 자연어 생성을 하는 RNN은 비교적 짧은 sequence에 대해서만 효과를 보여, time step이 길어질 수록 앞의 정보가 뒤로 충분히 전달되지 못하는 현상



LSTM 모델의 학습은 아래와 같다.

BERT에서 분류된 눈의 색과 머리의 색으로 소설 묘사글이 출력되도록 학습시켰다. 소설 묘사글은 직접 작성하였다.

![image](https://user-images.githubusercontent.com/60170358/143965845-b00ecf7a-c88e-4eb9-832a-4395b6389df1.png)




최종 모델 다이어그램은 아래 사진과 같다.


![image](https://user-images.githubusercontent.com/60170358/143965950-707a937b-863c-480f-95ca-6302d4736713.png)



------



## 기대효과

**1. 기존 앱의 시장성**

먼저 기존 기술로 인공지능이 소설을 쓰는 방법은 기존 소설의 문장들을 학습한 후, 사람이 인과 관계에 따른 사건 배열을 의미하는 플롯을 구성하여 모델에 입력하면, 맥락을 파악하여 소설 글을 작성하는 방식이다. 

앞서 말한 방식 인공지능이 쓴 장편 소설 ‘지금부터의 세계’ 가 출시되었고, 실제로 이 소설은 ‘인공지능이 쓴 소설’ 이라는 키워드로 독자들의 흥미를 끌어 yes24에서 한국소설 top 100에 들기도 하였다.

이렇게 AI가 쓴 소설인 ‘지금부터의 세계’의 좋은 평점들과 독자들의 반응이 긍정적인 것을 보아, ‘AI가 집필한 소설’이라는 키워드는 사람들의 흥미를 끌며 시장성이 있다고 판단하였다.



**2. 사업화 모델**

첫 번째로, 자제 홈페이지 런칭을 통해 사용자가 외형 정보를 입력하면 해당하는 외형 묘사 소설 글을 출력해주는 홈페이지를 만드는데, 무료와 유료의 두 가지 버전으로 정리하였다.

먼저 무료 버전의 경우 횟수 및 조건에 제한을 걸고 광고를 달아 수익 창출을 한다.

유료 버전의 경우 무료 버전에서 있던 제한을 없애고, 더 자연스럽고 풍부한 묘사 글을 출력하여, 이 버전에서는 작가들이 실제로 업무에 사용이 가능하도록 해줍니다.



두 번째로, 게임 분야와의 결합이다. 사용자 캐릭터의 얼굴 데이터에 맞춰 게임 NPC들의 캐릭터 얼굴 묘사 대사가 생성되는 사용자 맞춤 서비스를 게임 회사에 제공함으로써 수익 창출이 가능하다.



**3. 보완점**

코퍼스를 직접 작성하여 학습을 시켰지만, 학습 데이터가 많지 않아서, 분류의 정확도가 높지 않았고, 생성되는 문장의 스펙트럼이 넓지 않았으며, 문법 역시 어색했다. 그래서 더욱 다양한 코퍼스를 수집하고 더 많이 학습을 시켜서 보완해야 한다.

또한, 사용한 기술이 문법이 어색하고, 생성할 문장의 길이(단어의 개수)를 지정해주어야 한다는 점에서 불편함이 있었다. 이 한계점은 연구를 통해 lstm의 성능을 더욱 향상시키거나, 더욱 발전된 모델을 사용하여 정확도를 높일 필요가 있다.

